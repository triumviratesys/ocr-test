<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Enhanced OCR System</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header class="app-header">
        <h1>ü§ñ AI-Enhanced OCR System</h1>
        <p>Azure Computer Vision + GPT-4o with RAG Context</p>
    </header>

    <nav class="app-nav">
        <button class="nav-btn active" data-tab="ocr">OCR Upload</button>
        <button class="nav-btn" data-tab="notesets">Note Sets</button>
        <button class="nav-btn" data-tab="context">Context Library</button>
    </nav>

    <main class="app-main">
        <!-- OCR Tab -->
        <div id="ocr-tab" class="tab-content active">
            <!-- Upload Section -->
            <section class="upload-section">
                <h2>Upload Image(s) for OCR</h2>

                <div class="upload-mode-toggle">
                    <button class="mode-btn active" data-mode="single">Single File</button>
                    <button class="mode-btn" data-mode="batch">Batch Upload</button>
                </div>

                <!-- Single Upload -->
                <div id="single-upload" class="upload-controls">
                    <input type="file" id="file-input" accept="image/*">
                    <button id="upload-btn" class="upload-btn">Upload & Process</button>
                </div>

                <!-- Batch Upload -->
                <div id="batch-upload" class="upload-controls" style="display: none;">
                    <input type="file" id="batch-file-input" accept="image/*" multiple>
                    <input type="text" id="noteset-name" placeholder="Note Set Name (optional)" class="text-input">
                    <button id="batch-upload-btn" class="upload-btn">Upload Batch & Process</button>
                </div>

                <p id="selected-file" class="selected-file"></p>

                <div id="error-message" class="error-message" style="display: none;"></div>

                <div id="upload-result" class="upload-result" style="display: none;">
                    <h3>‚úÖ Processing Complete!</h3>
                    <p><strong>File:</strong> <span id="result-filename"></span></p>
                    <p><strong>OCR Confidence:</strong> <span id="result-confidence"></span>%</p>
                    <p><strong>AI Enhanced:</strong> <span id="result-ai-status"></span></p>

                    <div class="tabs-container">
                        <div class="tabs">
                            <button class="tab-btn active" data-text="cleaned">‚ú® AI-Cleaned Text</button>
                            <button class="tab-btn" data-text="raw">üìù Raw OCR</button>
                        </div>

                        <div id="cleaned-text-panel" class="text-panel active">
                            <div class="ocr-text-box">
                                <div id="result-cleaned-text" class="markdown-content"></div>
                            </div>
                        </div>

                        <div id="raw-text-panel" class="text-panel">
                            <div class="ocr-text-box">
                                <pre id="result-text"></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="loading" class="loading" style="display: none;">
                    <div class="spinner"></div>
                    <p>Processing OCR and AI enhancement... This may take 15-30 seconds</p>
                </div>
            </section>

            <!-- Documents List -->
            <section class="documents-section">
                <h2>Processed Documents (<span id="doc-count">0</span>)</h2>
                <div id="documents-list" class="documents-list">
                    <p class="no-documents">No documents uploaded yet</p>
                </div>
            </section>
        </div>

        <!-- Note Sets Tab -->
        <div id="notesets-tab" class="tab-content">
            <section class="notesets-section">
                <h2>üìö Note Sets (<span id="noteset-count">0</span>)</h2>
                <p class="section-description">Manage collections of documents for multi-page note sets</p>

                <div id="notesets-list" class="notesets-list">
                    <p class="no-documents">No note sets created yet</p>
                </div>
            </section>

            <!-- Note Set Viewer (shows when a note set is selected) -->
            <div id="noteset-viewer" class="noteset-viewer" style="display: none;">
                <div class="viewer-header">
                    <button id="close-viewer" class="close-btn">‚Üê Back to Note Sets</button>
                    <h2 id="viewer-noteset-name"></h2>
                    <button id="edit-noteset-name" class="edit-name-btn">‚úèÔ∏è Rename</button>
                </div>

                <div class="viewer-controls">
                    <button id="prev-doc" class="nav-arrow-btn" disabled>‚óÄ</button>
                    <span id="doc-position" class="doc-position">1 / 1</span>
                    <button id="next-doc" class="nav-arrow-btn" disabled>‚ñ∂</button>
                </div>

                <div id="viewer-document" class="viewer-document">
                    <div class="document-info-bar">
                        <span id="viewer-filename"></span>
                        <span id="viewer-confidence"></span>
                    </div>

                    <div class="tabs-container">
                        <div class="tabs">
                            <button class="tab-btn active" data-text="cleaned">‚ú® AI-Cleaned Text</button>
                            <button class="tab-btn" data-text="raw">üìù Raw OCR</button>
                        </div>

                        <div id="viewer-cleaned-panel" class="text-panel active">
                            <div class="ocr-text-box scrollable">
                                <div id="viewer-cleaned-text" class="markdown-content"></div>
                            </div>
                        </div>

                        <div id="viewer-raw-panel" class="text-panel">
                            <div class="ocr-text-box scrollable">
                                <pre id="viewer-raw-text"></pre>
                            </div>
                        </div>
                    </div>

                    <div class="viewer-actions">
                        <button id="move-doc-up" class="action-btn">‚Üë Move Up</button>
                        <button id="move-doc-down" class="action-btn">‚Üì Move Down</button>
                        <button id="remove-from-set" class="action-btn delete-btn">Remove from Set</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Context Tab -->
        <div id="context-tab" class="tab-content">
            <section class="context-section">
                <h2>üìö Context Document Library</h2>
                <p class="section-description">Upload reference documents to improve AI text cleaning with domain-specific terminology</p>

                <div class="context-upload-section">
                    <h3>Add New Context Document</h3>
                    <div class="upload-controls">
                        <input type="file" id="context-file-input" accept=".txt,.md,.json,.csv,.pdf">
                        <input type="text" id="context-description" placeholder="Description (optional)" class="text-input">
                        <input type="text" id="context-category" placeholder="Category (e.g., medical, legal)" class="text-input">
                        <button id="context-upload-btn" class="upload-btn">Upload Context</button>
                    </div>
                    <p id="context-selected-file" class="selected-file"></p>
                    <div id="context-error-message" class="error-message" style="display: none;"></div>
                    <div id="context-success-message" class="success-message" style="display: none;"></div>
                </div>

                <div class="context-list-section">
                    <h3>Current Context Documents (<span id="context-count">0</span>)</h3>
                    <div id="context-list" class="context-list">
                        <p class="no-documents">No context documents uploaded yet</p>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
